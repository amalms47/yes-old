$("#category").select2(),$("#level").select2();var getcategoey=function(){$.post(site_url+"Administrator/getcoursecategory",function(e){if(0===e.error){$("#category").append('<option value="">Select category</option>');var t=e.category;for(var a in t){var r=t[a];$("#category").append('<option value="'+r.id+'">'+r.categoryname+"</option>")}}})},getselectcat=function(){$.post(site_url+"Administrator/getcoursecategory",function(e){if(0===e.error){$("#catselname").append('<option value="">Select category</option>');var t=e.category;for(var a in t){var r=t[a];$("#catselname").append('<option value="'+r.id+'">'+r.category+"</option>")}}})},getlevels=function(){$.post("Administrator/getcourselevel",function(e){if(0===e.error){var t=e.level;for(var a in t){var r=t[a];$("#level").append('<option value="'+r.level+'">'+r.level+"</option>")}}})},getcourses=function(e){$.post(site_url+"Administrator/getcourses",{search:$("#search").val(),page:e},function(e){var t="",a=1;if(0==e.error){var r=e.courses;for(var o in r){var s=r[o],c="Active";0==s.cactive&&(c="Blocked"),t+="<tr>",t+="<td>"+a+".</td>",a++,t+="<td>"+s.categoryname+"</td>",t+="<td>"+s.name+"</td>",t+="<td>"+s.addedby+"</td>",t+="<td>"+c+"</td>",1==s.cactive?t+='<td><span style="color: green;font-size: large" class="fa fa-check" onclick="activecourse('+s.cid+","+s.cactive+')"></a></td>':0==s.cactive&&(t+='<td><span  style="color: darkred;font-size: large" class="fa fa-times" onclick="activecourse('+s.cid+","+s.cactive+')"></a></td>'),t+='<td><button type="button" class="btn btn-primary " onclick="getcourse('+s.cid+')"><i class="fa fa-edit"></i> Edit</button></td>',t+="<tr>"}var i="",n=e.page_count;i+=' <ul class="pagination pagination-sm  pull-right" style="margin:0px;"><li><a  href="javascript:void(0);" onclick="getcourses(1)">«</a></li>';for(a=1;a<=n;a++)i+=' <li><a  href="javascript:void(0);" onclick="getcourses('+a+')">'+a+"</a></li>";i+='<li><a href="javascript:void(0);"  onclick="getcourses('+n+')">»</a></li>',$("#coursepages").html(i)}else t='<tr><td colspan="4">no information found at server</td></tr>';$("#coursebody").html(t)})},activecourse=function(e,t){var a="0";0==t&&(a=1),$.post(site_url+"Administrator/blockCourse",{option:a,id:e},function(e){getcourses(1)})},getcourse=function(e){$.post(site_url+"Administrator/getallcoursebyid",{id:e},function(e){$("#category").select2("trigger","select",{data:{id:e.courses.id}}),$("#name").val(e.courses.name),$("#btn_save").attr("selid",e.courses.cid),$("#btn_save").attr("value","edit")})},searchcourse=function(){$("#search").on("keyup",function(e){e.preventDefault(),getcourses(1)})},cleardata=function(){$("#cleardata").on("click",function(e){$("#category").val($("#category option:first-child").val()).trigger("change"),$("#name").val(""),$("#category").val(""),$("#btn_save").attr("selid",-1),$("#btn_save").attr("value","insert")})};getcategoey(),getlevels(),getcourses(1),searchcourse(),cleardata(),$(function(){getselectcat(),$.validator.setDefaults({errorClass:"help-block",highlight:function(e){$(e).closest(".form-group  ").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group ").removeClass("has-error")}}),$.validator.addMethod("pattern",function(e,t,a){return!!this.optional(t)||("string"==typeof a&&(a=new RegExp("^(?:"+a+")$")),a.test(e))},"Invalid input information."),$("#courseform").validate({rules:{name:{required:!0},category:{required:!0}},messages:{name:{required:"Please enter  the course name ."},category:{required:"Please enter  the course category ."}}})});var savecourse=function(){$("#courseform").on("submit",function(e){if(e.preventDefault(),!$("#courseform").valid())return!1;var t=$("#courseform").serializeArray();"insert"==$("#btn_save").attr("value")?$.post(site_url+"Administrator/savecourse",t,function(e){cleardata(),$("#custom_heading").html("Server response"),$("#custom_message").html(e.message),$("#alertmodal").modal({backdrop:"static",keyboard:!1}),cleardata(),$("#category").val(""),$("#name").val(""),$("#custom_heading").html("Server response"),$("#custom_message").html(e.message),$("#alertmodal").modal({backdrop:"static",keyboard:!1}),$("#category").val($("#category option:first-child").val()).trigger("change"),$("#name").val(""),$("#btn_save").attr("selid",-1),$("#btn_save").attr("value","insert"),getcourses(1)}):(t.push({name:"cid",value:$("#btn_save").attr("selid")}),$.post(site_url+"Administrator/updateallcourse",t,function(e){cleardata(),$("#category").val(""),$("#name").val(""),$("#custom_heading").html("Server response"),$("#custom_message").html(e.message),$("#alertmodal").modal({backdrop:"static",keyboard:!1}),$("#category").val($("#category option:first-child").val()).trigger("change"),$("#name").val(""),$("#btn_save").attr("selid",-1),$("#btn_save").attr("value","insert"),getcourses(1)}))})};savecourse();