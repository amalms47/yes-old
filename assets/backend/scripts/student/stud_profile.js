$(function(){saveAttachment(),uploadAttach(),getattachments(),getnotification(),savequalification(),getqualfication(),isprofilecomplete(),completeprofile(),uploadstudpicture(),savestudphoto(),isnotifications(),getalldata(),resetpassword(),getrequests(),jQuery.validator.addMethod("mobile_val",function(t,e){return this.optional(e)||/^[0-9]{10,10}$/.test(t)},"Phone number contains only numbers"),$("#newmobileform").validate({rules:{mobilenoedit:{required:!0,maxlength:10,minlength:10,mobile_val:!0}},messages:{mobilenoedit:{mobile_val:"Enter correct mobile number"}}})});var uploadAttach=function(){$("#brchuretriger").on("click",function(){if($.validator.setDefaults({highlight:function(t){$(t).closest(".form-group").addClass("has-error")},unhighlight:function(t){$(t).closest(".form-group").removeClass("has-error").addClass("has-success")}}),validators=$("#brochureform").validate({rules:{attchname:{required:!0}}}),$("#brochureform").valid())t=1;else{return!1;var t}1==t&&$("#brofile").trigger("click")})},saveAttachment=function(){$("#brofile").change(function(t){t.preventDefault();var e=new FormData(document.getElementById("brochureform"),document.getElementById("attchname"));$.ajax({url:site_url+"Student/uploadAttach",type:"POST",data:e,processData:!1,contentType:!1,enctype:"multipart/form-data",success:function(t){$("#Attachmsg").html(t.message),$("#attchname").val(""),getattachments(),0==t.error&&($("#Attachmsg").html(t.message),$("#Attachmsg").fadeOut(5e3),window.location.reload())}})})},getattachments=function(){var t="";t+="<tr>",t+=" <th>#</th>",t+="<th>ATTACHMENT (View)</th>",t+="<th>DATE</th>",t+="<th>REMOVE</th>",t+="</tr>",$.post(site_url+"Student/getAttachments",function(e){var a=1,i=(site_url,e.contents);for(var s in i){var o=i[s];t+="<tr>",t+=" <td>"+a+"</td>",a++,t+='<td><a  style="text-decoration: none;" target="_blank" href="'+o.attachment+'" >'+o.name+"</a></td>",t+="<td>"+o.date+"</td>",t+='<td><a id="" style="text-decoration: none;" href="javascript:void(0)" onclick="deleteAtttachs('+o.id+');"><i class="fa fa-times"></i>&nbsp;&nbsp;REMOVE</a></td>',t+="</tr>"}1==e.error&&(t+="<tr><td>No attachments found</td><td></td><td></td><td></td></tr> "),$("#attachs").html(t)})},deleteAtttachs=function(t){!0===confirm("Are you sure!...")&&$.post(site_url+"Student/deleteattach",{id:t},function(t){$("#custom_message").html(t.message),$("#myModal").modal({backdrop:"static",keyboard:!1}),getattachments()},"json").done(function(){getattachments()})},getqualfication=function(){$.post(site_url+"Student/getstudentdata",function(t){var e="",a=t.students;for(var i in a){var s=a[i];e+='<div class="faq-item">',e+='<div class="faq-item-a">',e+='<span class="faq-item-left">'+s.coursetitle+"</span>",e+='<span title="delete" style="float: right;padding-left: 13px;color:#a80d0d" class="fa fa-times" onclick="deletequalification('+s.id+')"></span>',e+='<span style="float: right;padding-left: 13px;" onclick="editqualification('+s.id+')">edit</span>',e+='<span class="faq-item-i"></span>',e+='<div class="clear"></div>',e+="</div>",e+='<div class="faq-item-b">',e+='<div class="faq-item-p">',e+='<div class="flight-d-text">',e+='<div class="tables">',e+='<div class="shortcodes">',e+='<table class="table-a">',e+="<tr>",e+="<td>NAME OF SCHOOL/COLLEGE</td>",e+=" <td>"+s.collegename+"</td>",e+="</tr>",e+="<tr>",e+="<td>UNIVERSITY</td>",e+="<td>"+s.courseuniversity+"</td>",e+="</tr>",e+="<tr>",e+="<td>PASSED YEAR</td>",e+="<td>"+s.coursepassdate+"</td>",e+="</tr>",e+="<tr>",e+="<td>% OF MARK SCORED</td>",e+="<td>"+s.coursemarks+"</td>",e+="</tr>",e+="</table>",e+="</div>",e+='<div class="clear"></div>',e+="</div>",e+="<br>",e+='<div class="complete-devider"></div>',e+="</div>",e+="</div>",e+=" </div>",e+="</div>"}$("#qualificationlist").html(e)}).done(function(){$(".faq-item-a").on("click",function(){var t=$(this).closest(".faq-item");t.is(".open")?(t.find(".faq-item-p").hide(),$(".faq-item").removeClass("open")):($(".faq-item").removeClass("open"),$(".faq-item-p").hide(),t.addClass("open").find(".faq-item-p").fadeIn())})})},editqualification=function(t){$.post(site_url+"Student/getQualbyid",{id:t},function(t){if(0==t.error){var e=t.content;for(var a in e)var i=e[a];$("#qualeditname").val(i.coursetitle),$("#qualid").val(i.id),$("#qualeditinstitution").val(i.collegename),$("#qualeditpercent").val(i.coursemarks),$("#qualedityear").val(i.coursepassdate),$("#qualedituniversity").val(i.courseuniversity),$("#qualeditModal").modal({backdrop:"static",keyboard:!1})}else $("#custom_message").html(t.message),$("#myModal").modal({backdrop:"static",keyboard:!1})}),$("#qualeditform").on("submit",function(){if($("#qualform").validate({rules:{qualeditname:{required:!0},qualeditpercent:{required:!0},qualedityear:{required:!0},qualedituniversity:{required:!0},qualeditinstitution:{required:!0}}}),!$("#qualeditform").valid())return!1;var t=$("#qualeditname").val(),e=$("#qualid").val(),a=$("#qualeditpercent").val(),i=$("#qualedityear").val(),s=$("#qualedituniversity").val(),o=$("#qualeditinstitution").val();$.post(site_url+"Student/updateQualification",{id:e,name:t,marks:a,year:i,board:s,inst:o},function(t){$("#qualeditdismissbutton").click(),$("#custom_heading").html("Server response"),$("#custom_message").html(t.message),$("#myModal").modal({backdrop:"static",keyboard:!1})})}),getalldata()},isprofilecomplete=function(){$.post(site_url+"Student/checkProfilecomplete",function(t){1==t.error&&$("#pronotcomplete").html("(Profile not completed)")})},isnotifications=function(){$.post(site_url+"Student/getunreadnoti",function(t){1==t.error&&($("#unreadmsg").show(),$("#unreadmsg").html("You have unread notifications"))})},completeprofile=function(){$.validator.setDefaults({highlight:function(t){$(t).closest(".form-group").addClass("has-error")},unhighlight:function(t){$(t).closest(".form-group").removeClass("has-error").addClass("has-success")}}),$("#completeprofileform").validate({rules:{firstname:{required:!0,minlength:2},lastname:{required:!0},gender:{required:!0},dob:{required:!0},contactno:{required:!0,mobile_val:!0},studstate:{required:!0},studcity:{required:!0}},messages:{firstname:{required:"Firsname is required",minlength:"Atleast 2 charactors"},lastname:{required:"Lastname is required "},gender:{required:"Please select your gender"},dob:{required:"Enter your date of birth "},contactno:{required:"Mobile number is required ",mobile_val:"Mobile number contain 10 digit numbers"},studstate:{required:"Select your state  "},studcity:{required:"Select your city "}}}),$("#completeprofileform").on("submit",function(t){if(t.preventDefault(),!$("#completeprofileform").valid())return!1;var e=$("#firstname").val(),a=$("#lastname").val(),i=$("#dob").val(),s=$("#gender").val(),o=$("#state").val(),r=$("#district").val(),l=$("#contactno").val();$.post("Student/Completestudentprofile",{firstname:e,lastname:a,dob:i,gender:s,studstate:o,studcity:r,number:l},function(t){$("#dismissbutton").click(),$("#custom_heading").html("Server response"),$("#custom_message").html(t.message),$("#myModal").modal({backdrop:"static",keyboard:!1})})})},getrequests=function(){$.post(site_url+"Student/getrequests",function(t){var e="";if(0==t.error){var a=t.values;for(var i in a){var s=a[i];e+="<h2>"+s.title+"</h2>",e+='<div class="column mm-12" style="margin-left: 10px;">',e+=' <div class="complete-info-table">',e+='<div class="complete-info-i">',e+='<div class="complete-info-l"><b>Applied on :</b></div>',e+='<div class="complete-info-r">'+s.mdate+"</div>",e+='<div class="complete-info-l"><b>Applied for :</b></div>',e+='<div class="complete-info-r">'+s.coursename+"</div>",e+='<div class="complete-info-l"><b>Message :</b></div>',e+='<div class="complete-info-r">'+s.message+"</div>",e+=' <div class="complete-info-l"><b>Status :</b></div>',e+=' <div class="complete-info-r">'+s.status+"</div>",e+="</div>",e+=" </div>",e+="</div>",e+='<div class="clear"></div>'}}else e=t.message;$("#requestsection").html(e)})},getnotification=function(){$.post(site_url+"Student/getnotifications",function(t){console.log(t);var e="";if(0==t.error){var a=t.values;for(var i in a){var s=a[i];e+="<h2>"+s.title+"</h2>",e+='<div class="column mm-12" style="margin-left: 10px;">',e+=' <div class="complete-info-table">',e+='<div class="complete-info-i">',e+='<div class="complete-info-l"><b>Applied on :</b></div>',e+='<div class="complete-info-r">'+s.mdate+"</div>",e+='<div class="complete-info-l"><b>Applied for :</b></div>',e+='<div class="complete-info-r">'+s.coursename+"</div>",e+='<div class="complete-info-l"><b>Reply :</b></div>',e+='<div class="complete-info-r">'+s.reply+"</div>",0==s.issview?e+=' <div class="complete-info-l"><a target="_blank"  href="javascript:void(0)" onclick="markasread('+s.id+');"><span class="badge" style="background-color: #c12222;font-weight: lighter">Mark as read</span></a></div>':e+='<div class="complete-info-r" style="color: #11a022;">&#10004;&nbsp;seen</div>',e+="</div>",e+=" </div>",e+="</div>",e+='<div class="clear"></div>'}}else e=t.message;$("#notificationsection").html(e)})},markasread=function(t){$.post(site_url+"Student/marknotificationread",{id:t},function(t){0==t.error||1==t.error&&($("#custom_heading").html(),$("#custom_message").html(t.message),$("#myModal").modal({backdrop:"static",keyboard:!1}))}).done(function(){getnotification(),setTimeout(function(){location.reload()},2e3)})},uploadstudpicture=function(){$("#propictriger").on("click",function(){$("#propic").trigger("click")})},savestudphoto=function(){$("#propic").change(function(t){var e=new FormData(document.getElementById("propicform"));$.ajax({url:"Student/uploadstudpropic",type:"POST",data:e,processData:!1,contentType:!1,enctype:"multipart/form-data",success:function(t){$("#custom_heading").html("Server response"),$("#custom_message").html(t.message),$("#myModal").modal({backdrop:"static",keyboard:!1})}}),$("#myModal").on("click",function(){location.reload(!0)})})},savequalification=function(){$("#qualform").on("submit",function(){if($("#qualform").validate({rules:{qualname:{required:!0},qualpercent:{required:!0},qualyear:{required:!0},qualuniversity:{required:!0},qualinstitution:{required:!0}}}),!$("#qualform").valid())return!1;var t=$("#qualname").val(),e=$("#qualpercent").val(),a=$("#qualyear").val(),i=$("#qualuniversity").val(),s=$("#qualinstitution").val();$.post("Student/saveQualification",{name:t,marks:e,year:a,board:i,inst:s},function(t){$("#qualdismissbutton").click(),$("#custom_heading").html("Server response"),$("#custom_message").html(t.message),$("#myModal").modal({backdrop:"static",keyboard:!1})})}),getalldata()},getalldata=function(){$.post("Student/getstudentdata",function(t){if(0==t.error){var e="",a=t.students;for(var i in a){var s=a[i];e+='<div class="jumbotron text-left" id="qualshow">',e+=' <h4 class="text-primary">'+s.coursetitle+"</h4>",e+='<table class="table" style="border: 0px;">',e+="<tbody>",e+=" <tr>",e+=" <th>INSTITUTION NAME</th>",e+="<td>"+s.institutename+"</td>",e+="</tr>",e+="<tr><th>STREAM</th> <td>"+s.coursetitle+"</td> </tr>",e+="<tr>",e+="<th>PASSED YEAR</th>",e+="<td>"+s.coursepassdate+"</td>",e+="</tr>",e+=" <tr>",e+="<th>MARKS (%)</th>",e+="<td>"+s.coursemarks+"</td>",e+="</tr>",e+="</tbody>",e+=" </table>",e+="</div>"}$("#edu").html(e)}else{e="";e+='<tr><td id="nodata" class="mailbox-star" colspan="3">Add your qualification details here</td></tr>',$("#notableshow").html(e),$("#qualificationtable").css("visibility","hidden")}})},deletequalification=function(t){!0===confirm("Are you sure!...")&&($.post(site_url+"Student/deletequalification",{id_data:t},function(t){$("#custom_heading").html("Server response"),$("#custom_message").html(t.message),$("#myModal").modal({backdrop:"static",keyboard:!1})}),getqualfication())},resetpassword=function(){$("#studenteditpasswordform").on("submit",function(){if($.validator.setDefaults({errorClass:"help-block",highlight:function(t){$(t).closest(".form-group  ").addClass("has-error")},unhighlight:function(t){$(t).closest(".form-group ").removeClass("has-error")}}),$("#studenteditpasswordform").validate({rules:{newpass:{required:!0,pass_val:!0},cnewpass:{required:!0,equalTo:"#newpass"},oldpass:{required:!0,pass_val:!0}},messages:{required:"Please fille this field",pass_val:"Password must contain 6 charactors"}}),jQuery.validator.addMethod("pass_val",function(t,e){return this.optional(e)||/^(?=.*?[a-zA-Z0-9@#%$;])[a-zA-Z0-9@#%$;]{6,12}$/.test(t)},"Must have  6 charactors not morethan 12 charactors"),!$("#studenteditpasswordform").valid())return!1;var t=$("#studenteditpasswordform").serialize();$.post("Student/editstudpassword",t,function(t){$("#passdismissbutton").click(),$("#custom_heading").html("Server response"),$("#custom_message").html(t.message),$("#myModal").modal({backdrop:"static",keyboard:!1})})})};