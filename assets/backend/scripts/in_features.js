$(function(){$('input[type="radio"].category').iCheck({radioClass:"iradio_flat-blue"}),$('input[type="radio"].choice').iCheck({radioClass:"iradio_flat-blue"}),$("#new_feature").click(function(){$("#new_feature_panel").slideToggle()}),$("#cancel").click(function(){$("#featureform").validate().resetForm(),$("#new_feature_panel").slideToggle(),$("#save").val("New"),$("#save").attr("selid",-1)}),$("#details").wysihtml5({toolbar:{"font-styles":!0,emphasis:!0,lists:!0,html:!0,link:!1,image:!1,color:!0,blockquote:!1}}),$.validator.setDefaults({errorClass:"help-block",highlight:function(e){$(e).closest(".form-group  ").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group ").removeClass("has-error")}}),$.validator.addMethod("pattern",function(e,t,a){return!!this.optional(t)||("string"==typeof a&&(a=new RegExp("^(?:"+a+")$")),a.test(e))},"Invalid input information."),savefeature(),loadfeatures()}).ajaxStart(function(){Pace.restart()});var savefeature=function(){$("#featureform").validate({ignore:":hidden:not(textarea)",rules:{title:{required:!0},pic:{required:!0},details:{required:!0}},messages:{title:{required:"Please enter title."},pic:{required:"Please enter picture."},details:{required:"Please enter details."}}}),$("#featureform").on("submit",function(e){if(e.preventDefault(),!$("#featureform").valid())return!1;$("input[name='option']:checked").val();if("New"===$("#save").val()){var t=new FormData(document.getElementById("featureform"));$.ajax({url:"Institute/createFeature",type:"POST",data:t,processData:!1,contentType:!1,enctype:"multipart/form-data",success:function(e){$("#custom_message").html(e.message),$("#myModal").modal({backdrop:"static",keyboard:!1}),$("#featureform")[0].reset(),$("#new_feature_panel").slideToggle(),$("#save").val("New"),$("#save").attr("selid",-1)}}).done(function(){loadfeatures()})}else if("Update"===$("#save").val()){var a=$("#featureform").serializeArray();a.push({name:"id",value:$("#save").attr("selid")}),$.post("Institute/saveFeature",a,function(e){$("#custom_message").html(e.message),$("#myModal").modal({backdrop:"static",keyboard:!1})}).done(function(){loadfeatures()}),$("#featureform")[0].reset(),$("#new_feature_panel").slideToggle(),$("#save").val("New"),$("#save").attr("selid",-1),$("input#pic").prop("disabled",!1),$("iframe").contents().find(".wysihtml5-editor").html("")}})},loadfeatures=function(){$.post("Institute/getFeature",function(e){var t="";if(0==e.iserror){var a=e.features;for(var i in a){var r=a[i];t+='<div class="row" style="background-color: #dee2e8">',t+='<div class="col-md-3"><img class="img-responsive pad featphoto" src="'+r.picture+'" alt="Photo"></div>',t+='<div class="col-md-9" >',t+='<h3 id="title">'+r.title+"&nbsp;("+r.type+")</h3>",t+='<div  id="content" style="height:140px;text-align:justify;overflow:auto;background-color: #dee2e8";>'+r.content+"</div>",t+='<div class="box-footer" style="background-color: #dee2e8">',t+='<div class="pull-right"> <button type="submit" class="btn" style="background-color: #302d2c;color:white"" onclick="editfeatures('+r.id+')"><i class="fa fa-pencil"></i> Edit</button></div>',t+='<button type="reset" class="btn" style="background-color: #af311d;color:white" onclick="deletefeatures('+r.id+')"><i class="fa fa-times"></i> Delete</button>',t+="</div>",t+="</div>",t+="</div>"}}else t+='<tr><td class="mailbox-star" colspan="3">no information found at server</td>',$("#course_page").html("");$("#feature_body").html(t)})},deletefeatures=function(e){$.post("Institute/deleteFeature",{id:e},function(e){$("#custom_message").html(e.message),$("#myModal").modal({backdrop:"static",keyboard:!1})}).done(function(){loadfeatures()})},editfeatures=function(e){$.post("Institute/getFeatureById",{id:e},function(t){$("#title").val(t.features.title),$("iframe").contents().find(".wysihtml5-editor").html(t.features.content),!1===$("#new_feature_panel").is(":visible")&&$("#new_feature_panel").slideToggle(),$("#save").val("Update"),$("#save").attr("selid",e),$("input#pic").prop("disabled",!0)})};